# ClawAV-hardened sudoers for OpenClaw agent
# Generated by ClawAV installer — do not edit manually

# Read-only system inspection (no shell escape risk)
openclaw ALL=(ALL) NOPASSWD: /usr/bin/cat, /usr/bin/ls, /usr/bin/head, /usr/bin/tail, /usr/bin/grep, /usr/bin/find, /usr/bin/stat, /usr/bin/wc, /usr/bin/diff, /usr/bin/file, /usr/bin/readlink, /usr/bin/getent, /usr/bin/id, /usr/bin/whoami, /usr/bin/test, /usr/bin/sort, /usr/bin/uniq, /usr/bin/tr, /usr/bin/cut, /usr/bin/md5sum, /usr/bin/sha256sum, /usr/bin/strings

# System monitoring (read-only, no shell escape)
openclaw ALL=(ALL) NOPASSWD: /usr/bin/journalctl, /usr/bin/dmesg, /usr/bin/ss, /usr/sbin/lsof, /usr/bin/lsof, /usr/bin/df, /usr/bin/du, /usr/bin/free, /usr/bin/uptime, /usr/bin/ps, /usr/bin/ip, /usr/sbin/ip

# Systemctl — status/start/restart only (no stop/disable/mask, no systemd-run)
openclaw ALL=(ALL) NOPASSWD: /usr/bin/systemctl status *, /usr/bin/systemctl is-active *, /usr/bin/systemctl show *, /usr/bin/systemctl list-units *, /usr/bin/systemctl list-timers *, /usr/bin/systemctl start *, /usr/bin/systemctl restart *, /usr/bin/systemctl enable *, /usr/bin/systemctl daemon-reload

# Package management (apt has no shell escape)
openclaw ALL=(ALL) NOPASSWD: /usr/bin/apt, /usr/bin/apt-get, /usr/bin/dpkg, /usr/bin/apt-cache

# All other privileged operations go through clawsudo
openclaw ALL=(ALL) NOPASSWD: /usr/local/bin/clawsudo *

# Explicit denials — belt and suspenders
openclaw ALL=(ALL) !ALL
